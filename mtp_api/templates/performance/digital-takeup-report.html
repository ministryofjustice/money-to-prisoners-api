{% extends 'admin/base_site.html' %}
{% load admin_urls %}
{% load i18n %}
{% load static %}
{% load credit %}
{% load simple_admin %}

{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" type="text/css" href="{% static 'admin/css/changelists.css' %}" />
{% endblock %}

{% block bodyclass %}{{ block.super }} change-list{% endblock %}

{% block breadcrumbs %}
  <div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
    &rsaquo; <a href="{% url opts|admin_urlname:'changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
    &rsaquo; {{ title }}
  </div>
{% endblock %}

{% block content %}
  <div id="content-main">
    <div id="changelist" class="module filtered">
      <div id="changelist-filter">
        <h2>{% trans 'Filter' %}</h2>

        <h3>{{ form.period.label }}</h3>
        {% admin_choice_list form form.period %}

        <h3>{{ form.show_reported.label }} *</h3>
        {% admin_choice_list form form.show_reported %}
      </div>

      <div class="results">
        <table>
          <thead>
            <tr>
              <th></th>
              {% if show_reported %}
                <th><div class="text quiet"><span>{% trans 'Reported digital credits' %} *</span></div></th>
                <th><div class="text quiet"><span>{% trans 'Reported postal credits' %} *</span></div></th>
              {% endif %}
              <th><div class="text"><span>{% trans 'Average digital take-up' %}</span></div></th>
              <th><div class="text"><span>{% trans 'Digital credits' %}</span></div></th>
              <th><div class="text"><span>{% trans 'Extrapolated postal credits' %} *</span></div></th>
            </tr>
          </thead>
          <tbody>
            {% for row in rows %}
              <tr class="{% cycle 'row1' 'row2' %}">
                <td>{{ row.date }}</td>
                {% if show_reported %}
                  <td class="quiet">{{ row.reported_credits_by_mtp|format_number }}</td>
                  <td class="quiet">{{ row.reported_credits_by_post|format_number }}</td>
                {% endif %}
                <td>{{ row.digital_takeup|format_percentage }}</td>
                <td>{{ row.accurate_credits_by_mtp|format_number }}</td>
                <td>{{ row.extrapolated_credits_by_post|format_number }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>

        <br/>
        <p>
          *
          {% trans 'Digital take-up is based on reports from NOMIS.' %}
          {% trans 'These reports do not accurately show the number of credits received by post nor digitally.' %}
          {% trans 'Assuming that digital take-up is correct (i.e. the proportion of each), the postal credits are extrapolated from the known number of digital credits which we track.' %}
        </p>
      </div>
    </div>
  </div>
{% endblock %}
