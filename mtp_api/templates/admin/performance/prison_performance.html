{% extends 'admin/base_site.html' %}
{% load i18n %}
{% load admin_urls %}
{% load static %}
{% load credit %}
{% load simple_admin %}


{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" type="text/css" href="{% static 'admin/css/changelists.css' %}" />
  <link rel="stylesheet" type="text/css" href="{% static 'stylesheets/digital-takeup-reports.css' %}"/>
{% endblock %}

{% block bodyclass %}{{ block.super }} change-list{% endblock %}

{% block breadcrumbs %}
  <div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
    &rsaquo; <a href="{% url opts|admin_urlname:'changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
    &rsaquo; {{ title }}
  </div>
{% endblock %}

{% block content %}
<p>
  <a href="#takeup-report-notes">
    {% trans 'See important notes below' %}â€¦
  </a>
</p>

<div id="content-main">
<div id="changelist" class="module filtered">
  <div id="changelist-filter">
    <h2>{% trans 'Filter' %}</h2>
    <h3>{{ form.days.label }}</h3>
    {% admin_choice_list form form.days %}
  </div>

  <div class="results">
    <table>
    <thead>
      <tr>
        <th class="{% if form.cleaned_data.order_by == 'nomis_id' %}sorted{% else %}sortable{% endif %}">
          <div class="text">
            <a href="?{{ days_query }}&amp;order_by=nomis_id{% if not form.cleaned_data.desc %}&amp;desc=1{% endif %}">
              {% trans 'Prison' %}
            </a>
          </div>
        </th>
        <th class="{% if form.cleaned_data.order_by == 'credits_by_post' %}sorted{% else %}sortable{% endif %}">
          <div class="text">
            <a href="?{{ days_query }}&amp;order_by=credits_by_post{% if not form.cleaned_data.desc %}&amp;desc=1{% endif %}">
              {% trans 'NOMIS postal credits' %}
            </a>
          </div>
        </th>
        <th class="{% if form.cleaned_data.order_by == 'credits_by_mtp' %}sorted{% else %}sortable{% endif %}">
          <div class="text">
            <a href="?{{ days_query }}&amp;order_by=credits_by_mtp{% if not form.cleaned_data.desc %}&amp;desc=1{% endif %}">
              {% trans 'NOMIS digital credits' %}
            </a>
          </div>
        </th>
        <th class="{% if form.cleaned_data.order_by == 'digital_takeup' %}sorted{% else %}sortable{% endif %}">
          <div class="text">
            <a href="?{{ days_query }}&amp;order_by=digital_takeup{% if not form.cleaned_data.desc %}&amp;desc=1{% endif %}">
              {% trans 'Average digital take-up' %}
            </a>
          </div>
        </th>
      </tr>
    </thead>
    <tbody>
      {% for prison in prisons %}
        <tr class="{% cycle 'row1' 'row2' %}">
          <td>{{ prison.name }}</td>
          <td>{{ prison.credits_by_post|format_number }}</td>
          <td>{{ prison.credits_by_mtp|format_number }}</td>
          <td>{{ prison.digital_takeup|format_percentage }}</td>
        </tr>
      {% endfor %}
    </tbody>
    </table>

    <section id="takeup-report-notes">
      <h2>{% trans 'Notes on this report' %}</h2>
      <dl>
        <dt>{% trans 'Digital take-up' %}</dt>
        <dd>
          {% trans 'Digital take-up is the proportion of credits received through the digital service.' %}
          {% trans 'This is based on reports from NOMIS.' %}
          {% trans 'NOMIS reports do not always show the accurate number of credits received neither by post nor digitally across the public estate.' %}
          {% trans 'They do not include the private estate at all.' %}
        </dd>
      </dl>
    </section>
  </div>
</div>
</div>
{% endblock %}
